<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>登录</title>

    <link rel="stylesheet" href="/css/index/index.css">
</head>
<body>
<div class="dowebok">
    <div class="logo"></div>
    <div class="form-item">
        <input id="userName" type="text" autocomplete="off" placeholder="用户名" onkeyup="userNameCheck(event)">
    </div>
    <div class="form-item">
        <input id="passWord" type="password" autocomplete="off" placeholder="登录密码" onkeyup="userPassCheck(event)">
    </div>
    <div class="form-item">
        <button id="submit">登 录</button>
    </div>
    <div class="reg-bar">
        <a class="reg" href="../user/register.html">立即注册</a>
        <a class="forget" href="">忘记密码</a>
    </div>
</div>
<script src="/js/public/jquery-1.11.2.min.js"></script>
<script src="/js/layer/layer.js"></script>
<script>
    $(function () {
        //点击校验
        $('#submit').on('click', function () {

            //抓取用户名密码
            var userName = $('#userName').val();
            var passWord = $('#passWord').val();

            //登录校验
            if (userName == '') {
                //用户名判空
                layer.alert('<p style="color:black"><b>用户名不能为空！</b></p>', {icon: 0});
                return;
            } else if (passWord == '') {
                //用户密码判空
                layer.alert('<p style="color:black"><b>密码不能为空！</b></p>', {icon: 0});
                return;
            } else {
                //后台数据校验登录
                $.ajax({
                    url: '/user/checkUser',
                    type: 'post',
                    data: {
                        "userName": userName,
                        "userPass": passWord
                    },
                    // contentType: "application/json",
                    success: function (res) {
                        //此处演示关闭
                        setTimeout(function () {
                            layer.closeAll('loading');
                        }, 2000);
                        //如果登录成功
                        if (res.status == 'ok') {
                            //跳转页面
                            localStorage.setItem('userNo', res.user.userNo);
                            window.location.href = '../main/main.html';
                        } else {
                            layer.load(1);
                            //提示登录失败
                            layer.alert('<p style="color:black"><b>用户名或者密码错误！</b></p>', {icon: 2});
                            return;
                        }
                    }
                });
            }
        })
    })

</script>
</body>
</html>